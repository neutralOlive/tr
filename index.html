<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <title>D</title>
</head>
<body>
    <div class="root">

        <span class="left-container">
            <div class="period-container">

            </div>

        </span>

        <span class="center-container">
            <div class="timetable-container">
                <!-- timetable -->
                <div class="hours-container" id="7">
                    <span class="hour-written">7</span>
                    <!-- <div class="minute6-container"> -->
                        <span class="minutes-container leftest" id="7:10"></span>
                        <span class="minutes-container" id="7:20"></span>
                        <span class="minutes-container" id="7:30"></span>
                        <span class="minutes-container" id="7:40"></span>
                        <span class="minutes-container" id="7:50"></span>
                        <span class="minutes-container" id="7:60"></span>
                    <!-- </div> -->
                    

                </div>
                <div class="hours-container" id="8">
                    <span class="hour-written">8</span>
                    <span class="minutes-container leftest" id="8:10"></span>
                    <span class="minutes-container" id="8:20"></span>
                    <span class="minutes-container" id="8:30"></span>
                    <span class="minutes-container" id="8:40"></span>
                    <span class="minutes-container" id="8:50"></span>
                    <span class="minutes-container" id="8:60"></span>

                </div>
                <div class="hours-container" id="9">
                    <span class="hour-written">9</span>

                    <span class="minutes-container leftest" id="9:10"></span>
                    <span class="minutes-container" id="9:20"></span>
                    <span class="minutes-container" id="9:30"></span>
                    <span class="minutes-container" id="9:40"></span>
                    <span class="minutes-container" id="9:50"></span>
                    <span class="minutes-container" id="9:60"></span>


                </div>
                <div class="hours-container" id="10">
                    <span class="hour-written">10</span>
                    <span class="minutes-container leftest" id="10:10"></span>
                    <span class="minutes-container" id="10:20"></span>
                    <span class="minutes-container" id="10:30"></span>
                    <span class="minutes-container" id="10:40"></span>
                    <span class="minutes-container" id="10:50"></span>
                    <span class="minutes-container" id="10:60"></span>


                </div>
                <div class="hours-container" id="11">
                    <span class="hour-written">11</span>
                    <span class="minutes-container leftest" id="11:10"></span>
                    <span class="minutes-container" id="11:20"></span>
                    <span class="minutes-container" id="11:30"></span>
                    <span class="minutes-container" id="11:40"></span>
                    <span class="minutes-container" id="11:50"></span>
                    <span class="minutes-container" id="11:60"></span>

                </div>
                <div class="hours-container" id="12">
                    <span class="hour-written">12</span>
                    <span class="minutes-container leftest" id="12:10"></span>
                    <span class="minutes-container" id="12:20"></span>
                    <span class="minutes-container" id="12:30"></span>
                    <span class="minutes-container" id="12:40"></span>
                    <span class="minutes-container" id="12:50"></span>
                    <span class="minutes-container" id="12:60"></span>

                </div>
                <div class="hours-container" id="13">
                    <span class="hour-written">13</span>
                    <span class="minutes-container leftest" id="13:10"></span>
                    <span class="minutes-container" id="13:20"></span>
                    <span class="minutes-container" id="13:30"></span>
                    <span class="minutes-container" id="13:40"></span>
                    <span class="minutes-container" id="13:50"></span>
                    <span class="minutes-container" id="13:60"></span>

                </div>
                <div class="hours-container" id="14">
                    <span class="hour-written">14</span>
                    <span class="minutes-container leftest" id="14:10"></span>
                    <span class="minutes-container" id="14:20"></span>
                    <span class="minutes-container" id="14:30"></span>
                    <span class="minutes-container" id="14:40"></span>
                    <span class="minutes-container" id="14:50"></span>
                    <span class="minutes-container" id="14:60"></span>

                </div>
                <div class="hours-container" id="15">
                    <span class="hour-written">15</span>
                    <span class="minutes-container color leftest" id="15:10"></span>
                    <span class="minutes-container color" id="15:20"></span>
                    <span class="minutes-container color" id="15:30"></span>
                    <span class="minutes-container color" id="15:40"></span>
                    <span class="minutes-container color" id="15:50"></span>
                    <span class="minutes-container color" id="15:60"></span>

                </div>
                <div class="hours-container" id="16">
                    <span class="hour-written">16</span>
                    <span class="minutes-container color leftest" id="16:10"></span>
                    <span class="minutes-container color" id="16:20"></span>
                    <span class="minutes-container color" id="16:30"></span>
                    <span class="minutes-container color" id="16:40"></span>
                    <span class="minutes-container color" id="16:50"></span>
                    <span class="minutes-container color" id="16:60"></span>

                </div>
                <div class="hours-container" id="17">
                    <span class="hour-written">17</span>
                    <span class="minutes-container leftest" id="17:10"></span>
                    <span class="minutes-container" id="17:20"></span>
                    <span class="minutes-container" id="17:30"></span>
                    <span class="minutes-container" id="17:40"></span>
                    <span class="minutes-container" id="17:50"></span>
                    <span class="minutes-container" id="17:60"></span>
                </div>
                <div class="hours-container" id="18">
                    <span class="hour-written">18</span>
                    <span class="minutes-container leftest" id="18:10"></span>
                    <span class="minutes-container" id="18:20"></span>
                    <span class="minutes-container" id="18:30"></span>
                    <span class="minutes-container" id="18:40"></span>
                    <span class="minutes-container" id="18:50"></span>
                    <span class="minutes-container" id="18:60"></span>
                </div>
                <div class="hours-container" id="19">
                    <span class="hour-written">19</span>
                    <span class="minutes-container leftest" id="19:10"></span>
                    <span class="minutes-container" id="19:20"></span>
                    <span class="minutes-container" id="19:30"></span>
                    <span class="minutes-container" id="19:40"></span>
                    <span class="minutes-container" id="19:50"></span>
                    <span class="minutes-container" id="19:60"></span>
                </div>
                <div class="hours-container" id="20">
                    <span class="hour-written">20</span>
                    <span class="minutes-container leftest" id="20:10"></span>
                    <span class="minutes-container color" id="20:20"></span>
                    <span class="minutes-container color" id="20:30"></span>
                    <span class="minutes-container" id="20:40"></span>
                    <span class="minutes-container" id="20:50"></span>
                    <span class="minutes-container" id="20:60"></span>
                </div>
                <div class="hours-container" id="21">
                    <span class="hour-written">21</span>
                    <span class="minutes-container leftest" id="21:10"></span>
                    <span class="minutes-container color" id="21:20"></span>
                    <span class="minutes-container" id="21:30"></span>
                    <span class="minutes-container" id="21:40"></span>
                    <span class="minutes-container" id="21:50"></span>
                    <span class="minutes-container" id="21:60"></span>
                </div>
                <div class="hours-container" id="22">
                    <span class="hour-written">22</span>
                    <span class="minutes-container leftest" id="22:10"></span>
                    <span class="minutes-container" id="22:20"></span>
                    <span class="minutes-container" id="22:30"></span>
                    <span class="minutes-container" id="22:40"></span>
                    <span class="minutes-container" id="22:50"></span>
                    <span class="minutes-container" id="22:60"></span>
                </div>
                <div class="hours-container" id="23">
                    <span class="hour-written">23</span>
                    <span class="minutes-container leftest" id="23:10"></span>
                    <span class="minutes-container" id="23:20"></span>
                    <span class="minutes-container" id="23:30"></span>
                    <span class="minutes-container" id="23:40"></span>
                    <span class="minutes-container" id="23:50"></span>
                    <span class="minutes-container" id="23:60"></span>
                </div>
                <div class="hours-container" id="0">
                    <span class="hour-written">00</span>
                    <span class="minutes-container leftest" id="00:10"></span>
                    <span class="minutes-container" id="00:20"></span>
                    <span class="minutes-container" id="00:30"></span>
                    <span class="minutes-container" id="00:40"></span>
                    <span class="minutes-container" id="00:50"></span>
                    <span class="minutes-container" id="00:60"></span>
                </div>
                <div class="hours-container" id="1">
                    <span class="hour-written">1</span>
                    <span class="minutes-container leftest" id="1:10"></span>
                    <span class="minutes-container" id="1:20"></span>
                    <span class="minutes-container" id="1:30"></span>
                    <span class="minutes-container" id="1:40"></span>
                    <span class="minutes-container" id="1:50"></span>
                    <span class="minutes-container" id="1:60"></span>
                </div>

            </div>
        </span>

        <span class="right-container">
            <div class="pomodoro-container">
                
                <span class="work-container">
                    <div class="_25min-text-container" id="work-time">
                        <!-- 25 min text -->
                        25
                    </div>
                    <div class="_25min-bar-container" id="break-time">
                        <!-- 25 min bar -->
                        
                    </div>
                </span>
                <span class="break-container">
                    <div class="_5min-text-container">
                        <!-- 5 min text -->
                        5
                    </div>
                    <div class="_5min-bar-container">
                        <!-- 5 min bar -->
                        
                    </div>
                </span>
            </div>
            <hr class="line">
            <div class="totaltime-container">
                <!-- 누적 시간 적을거임 바로 text로 eg. 09:13  -->
                <div id="totaltime-text">00:00</div>
                
                <hr class="line">

            </div>
            <div class="island-and-button-container">
                <span class="island-container">

                </span>
                <span class="button-container">
                    <button id="button">Go</button>
                </span>
            </div>
        </span>
    </div>
    
</body>
<script>
    function startTimer(duration, display) {
        var timer = duration, minutes, seconds;
        setInterval(function () {
            minutes = parseInt(timer / 60, 10);

            minutes = minutes < 10 ? "0" + minutes : minutes;

            display.textContent = minutes + ":" + seconds;

            if (--timer < 0) {
                timer = duration;
            }
        }, 1000);
    }

    var paused = 0;
    var startHour = 0;
    var startMin = 0;
    var endHour = 0;
    var endMin = 0;
    var endHour_without0 = 0;
    var startHour_without0 = 0;
    var periodContainer = document.querySelector(".period-container");
    var totaltimeContainer = document.querySelector("#totaltime-text");
    var work_until = new Date();
    var break_until = new Date();
    var time_left = 25;
    var work_until_date;
    var work_until_hour;
    var work_until_min;



    function writeTime() {

        if (paused == 0) { // start
            // what time is it now :
            const now = new Date();
            
            // set 25 mins
            var workTime_container = document.querySelector("#work-time");
            console.log("time_left = "+time_left);
            work_until_date = new Date(now.getTime() + time_left*60000);
            work_until_hour = work_until_date.getHours();
            work_until_min = work_until_date.getMinutes();
            workTime_container.textContent = work_until_hour + ":" + work_until_min;

            // log current time
            startHour_without0 = now.getHours();
            startHour = ('0' + now.getHours()).slice(-2);
            startMin = ('0' + (now.getMinutes())).slice(-2);
            const current = startHour + ':' + startMin;
            
            // create new div and sylte it :
            var newPeriodDiv = document.createElement("DIV");
            newPeriodDiv.style.height = "5%";
            newPeriodDiv.style.margin = "5px";
            newPeriodDiv.style.fontSize = "25px";
            newPeriodDiv.style.alignContent = "center";
            newPeriodDiv.style.padding = "8px";
            newPeriodDiv.style.backgroundColor = "#D9D9D9";
            newPeriodDiv.style.color = "black";

            newPeriodDiv.style.borderRadius = "15px";
            newPeriodDiv.style.paddingLeft = "20px";
            // type in the time :
            newPeriodDiv.appendChild(document.createTextNode(current));
            // add the new div to container :
            periodContainer.insertBefore(newPeriodDiv, periodContainer.firstChild);

            // change what it says in the button :
            button.textContent = "Pause";

            // change var :
            paused = 1;
        } else if (paused == 1) { // pause
            
            // what time is it now :
            const now = new Date();

            console.log("work_until_date = " + work_until_date + ". now = " + now);
            var diff = work_until_date - now;
            console.log("before division, diff = " + diff);

            diff /= 60000;
            console.log("diff = " + diff);

            if (diff <= 6) { 
                time_left = 25;
            } else if (diff <= 0)  { 
                time_left = 25; 
            } else { 
                time_left = diff;
            }

            endHour_without0 = now.getHours();
            endHour = ('0' + now.getHours()).slice(-2);
            endMin = ('0' + (now.getMinutes())).slice(-2);
            const current = endHour + ':' + endMin;

            // change text :
            var toThisTime = " - " + current;
            periodContainer.firstChild.textContent += toThisTime

            // change what it says in the button :
            button.textContent = "Go";

            // change total time(sum) :
            var digitStartHour = parseInt(startHour);
            var digitStartMin = parseInt(startMin);
            var digitEndHour = parseInt(endHour);
            var digitEndMin = parseInt(endMin);
            var date = 1;
            if (digitEndHour < digitStartHour) {
                var date = 2;
            }
            var startTime = new Date(2000, 0, 1,  digitStartHour, digitStartMin); 
            var endTime = new Date(2000, 0, date, digitEndHour, digitEndMin); 
            var diff = endTime - startTime;
            var msec = diff;
            var hh = Math.floor(msec / 1000 / 60 / 60);
            msec -= hh * 1000 * 60 * 60;
            var mm = Math.floor(msec / 1000 / 60);
            msec -= mm * 1000 * 60;


            // type in the end time :
            var sum = totaltimeContainer.textContent.split(":")
            var sumHour = parseInt(sum[0]);
            var sumMin = parseInt(sum[1]);
            sumHour += hh;
            sumMin += mm;
            while (sumMin >= 60) {
                sumHour += 1;
                sumMin -= 60;
            }
            totaltimeContainer.textContent = sumHour + " : " + sumMin;
            
            var stringSearch = "";
            let minutes = [10, 20, 30, 40, 50, 60];
            var tempHour = startHour_without0;
            var tempMin = startMin;

            if (tempHour == endHour_without0) {
                minutes.forEach(function (item) {

                    if (item-5 >= tempMin && item-5 <= endMin) {

                        stringSearch = tempHour.toString() + ":" + item.toString();
                        var colorThis = document.getElementById(stringSearch);
                        colorThis.style.backgroundColor = "#A49393";
                        colorThis.classList.add("filled");

                    }
                })

            } else if (tempHour < endHour_without0) {
                while (tempHour < endHour_without0) {
                    if (tempHour > startHour_without0) {
                        minutes.forEach(function (item) {
                            stringSearch = tempHour.toString() + ":" + item.toString();
                            var colorThis = document.getElementById(stringSearch);
                            colorThis.style.backgroundColor = "#A49393";
                            colorThis.classList.add("filled");

                        })
                    } else {
                        minutes.forEach(function (item) {
                        if (item-5 >= tempMin) {
                            stringSearch = tempHour.toString() + ":" + item.toString();

                            var colorThis = document.getElementById(stringSearch);
                            colorThis.style.backgroundColor = "#A49393";
                            colorThis.classList.add("filled");

                            }
                        })
                    }
                    
                    tempHour++;
                }
                if (tempHour == endHour_without0) {
                    minutes.forEach(function (item) {
                        if (item-5 <= endMin) {
                            stringSearch = tempHour.toString() + ":" + item.toString();

                            var colorThis = document.getElementById(stringSearch);
                            colorThis.style.backgroundColor = "#A49393";
                            colorThis.classList.add("filled");

                        }
                    })
                }
            }


            // change var :
            paused = 0;
        }
        
    }

    // clicking button :
    var button = document.getElementById("button")
    button.addEventListener("click", function() {
        writeTime();
    })
    
    // if clicked, change to filled
    document.querySelectorAll('.minutes-container').forEach(item => {
        item.addEventListener('click', event => {
            if (item.classList.contains("filled")) {
                item.style.backgroundColor = "#F9F9F9";
                console.log("unfilled " + item.id);
                item.classList.remove("filled");
//                 item.classList.add("unfilled");

            } else {
                item.style.backgroundColor = "#A49393";
                console.log("filled " + item.id);
//                 item.classList.remove("unfilled");
                item.classList.add("filled");
            }

        })
    })
    
//     $().ready(function() {
//         $("#text").html("Text added by jQuery code.");
//     });
</script>
</html>
